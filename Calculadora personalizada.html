<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora personalizada</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        :root {
            --primary: #3498db;
            --primary-dark: #2980b9;
            --success: #2ecc71;
            --success-dark: #27ae60;
            --warning: #f39c12;
            --warning-dark: #d35400;
            --danger: #e74c3c;
            --danger-dark: #c0392b;
            --dark: #2c3e50;
            --light: #ecf0f1;
            --gray: #95a5a6;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
            display: flex;
            flex-direction: column;
        }
        
        .container {
            display: flex;
            flex: 1;
        }
        
        /* Menu Hamburguer e Lateral */
        .menu-toggle {
            display: none;
            position: fixed;
            top: 15px;
            left: 15px;
            z-index: 1001;
            background: var(--dark);
            color: white;
            border: none;
            border-radius: 8px;
            width: 50px;
            height: 50px;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        
        .sidebar {
            width: 280px;
            background: var(--dark);
            color: white;
            padding: 20px;
            transition: transform 0.3s ease;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
            overflow-y: auto;
            height: 100vh;
            position: sticky;
            top: 0;
        }
        
        .sidebar h2 {
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #34495e;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .sidebar h2 span {
            font-size: 24px;
        }
        
        .lists-menu {
            list-style: none;
            max-height: calc(100vh - 200px);
            overflow-y: auto;
        }
        
        .list-item {
            padding: 12px 15px;
            margin-bottom: 8px;
            background: #34495e;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .list-item:hover {
            background: #3d566e;
            transform: translateY(-2px);
        }
        
        .list-item.active {
            background: var(--primary);
            border-color: var(--light);
        }
        
        .list-actions {
            display: flex;
            gap: 8px;
        }
        
        .list-actions button {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 14px;
            padding: 5px 8px;
            border-radius: 5px;
            transition: background 0.3s;
        }
        
        .list-actions .edit-btn {
            background: var(--warning);
        }
        
        .list-actions .edit-btn:hover {
            background: var(--warning-dark);
        }
        
        .list-actions .delete-btn {
            background: var(--danger);
        }
        
        .list-actions .delete-btn:hover {
            background: var(--danger-dark);
        }
        
        .add-list-form {
            margin-top: 20px;
            display: flex;
            gap: 10px;
        }
        
        .add-list-form input {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
        }
        
        .add-list-form button {
            background: var(--success);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 0 20px;
            cursor: pointer;
            font-size: 20px;
            transition: background 0.3s;
        }
        
        .add-list-form button:hover {
            background: var(--success-dark);
        }
        
        /* Conte√∫do Principal */
        .main-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
            width: 100%;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--primary);
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .current-list {
            font-size: 24px;
            font-weight: 600;
            color: var(--dark);
            background: var(--light);
            padding: 10px 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .input-section {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        
        input {
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            flex: 1;
            min-width: 150px;
            transition: border-color 0.3s;
        }
        
        input:focus {
            border-color: var(--primary);
            outline: none;
        }
        
        button {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
            font-weight: 600;
        }
        
        button:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        .btn-danger {
            background-color: var(--danger);
        }
        
        .btn-danger:hover {
            background-color: var(--danger-dark);
        }
        
        .btn-success {
            background-color: var(--success);
        }
        
        .btn-success:hover {
            background-color: var(--success-dark);
        }
        
        .btn-warning {
            background-color: var(--warning);
        }
        
        .btn-warning:hover {
            background-color: var(--warning-dark);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            background: white;
            border-radius: 10px;
            overflow: hidden;
        }
        
        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: var(--dark);
            cursor: pointer;
            user-select: none;
            position: sticky;
            top: 0;
        }
        
        th:hover {
            background-color: #e9ecef;
        }
        
        tr:hover {
            background-color: #f1f8ff;
        }
        
        .position-1 {
            background-color: #fff9e6;
        }
        
        .position-2 {
            background-color: #f0f8ff;
        }
        
        .position-3 {
            background-color: #f9f2ff;
        }
        
        .position-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            text-align: center;
            line-height: 35px;
            font-weight: bold;
            color: white;
            margin-right: 10px;
        }
        
        .position-1 .position-badge {
            background-color: #ffc107;
        }
        
        .position-2 .position-badge {
            background-color: #6c757d;
        }
        
        .position-3 .position-badge {
            background-color: #fd7e14;
        }
        
        .position-other .position-badge {
            background-color: var(--primary);
        }
        
        .total-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 25px;
            padding: 20px;
            background-color: white;
            border-radius: 10px;
            font-size: 20px;
            font-weight: bold;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        
        .actions {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
            margin-top: 25px;
            flex-wrap: wrap;
        }
        
        .empty-message {
            text-align: center;
            padding: 40px;
            color: var(--gray);
            font-style: italic;
            background: white;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .item-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        .item-actions button {
            padding: 8px 12px;
            font-size: 14px;
            border-radius: 6px;
        }
        
        .edit-name-btn {
            background-color: var(--warning);
        }
        
        .edit-name-btn:hover {
            background-color: var(--warning-dark);
        }
        
        .edit-value-btn {
            background-color: #9b59b6;
        }
        
        .edit-value-btn:hover {
            background-color: #8e44ad;
        }
        
        .delete-item-btn {
            background-color: var(--danger);
        }
        
        .delete-item-btn:hover {
            background-color: var(--danger-dark);
        }
        
        .sort-indicator {
            margin-left: 5px;
            font-size: 12px;
        }
        
        /* Modal de Confirma√ß√£o */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            max-width: 400px;
            width: 90%;
            text-align: center;
        }
        
        .modal-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
        }
        
        /* Toast de notifica√ß√£o */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 15px 25px;
            background-color: var(--success);
            color: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 3000;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
        }
        
        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }
        
        .toast.error {
            background-color: var(--danger);
        }
        
        .toast.warning {
            background-color: var(--warning);
        }
        
        .toast.info {
            background-color: var(--primary);
        }
        
        /* Footer e Copyright */
        .copyright {
            text-align: center;
            padding: 20px;
            background-color: var(--dark);
            color: white;
            font-size: 14px;
            margin-top: auto;
        }
        
        .copyright a {
            color: var(--primary);
            text-decoration: none;
            font-weight: bold;
        }
        
        .copyright a:hover {
            text-decoration: underline;
            color: var(--primary-dark);
        }
        
        /* Responsividade */
        @media (max-width: 1024px) {
            .sidebar {
                width: 250px;
            }
        }
        
        @media (max-width: 768px) {
            .menu-toggle {
                display: block;
            }
            
            .sidebar {
                position: fixed;
                top: 0;
                left: 0;
                height: 100%;
                transform: translateX(-100%);
                z-index: 1000;
                width: 280px;
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
            
            .main-content {
                padding: 70px 20px 20px;
            }
            
            .input-section {
                flex-direction: column;
            }
            
            .actions {
                flex-direction: column;
            }
            
            .actions button {
                width: 100%;
            }
            
            .header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            table {
                font-size: 14px;
            }
            
            th, td {
                padding: 10px 8px;
            }
            
            .item-actions {
                flex-direction: column;
            }
            
            .item-actions button {
                width: 100%;
            }
            
            .toast {
                left: 20px;
                right: 20px;
                bottom: 20px;
            }
        }
        
        @media (max-width: 480px) {
            .current-list {
                font-size: 20px;
                width: 100%;
                text-align: center;
            }
            
            .total-section {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }
            
            .position-badge {
                width: 30px;
                height: 30px;
                line-height: 30px;
                font-size: 14px;
            }
        }
        
        /* Melhorias para Android */
        @media (max-width: 768px) and (orientation: portrait) {
            body {
                font-size: 16px; /* Previne zoom em inputs no iOS */
            }
            
            input, button {
                font-size: 16px; /* Previne zoom em inputs no iOS */
            }
        }
        
        /* Suporte para notch e √°reas seguras */
        @supports(padding: max(0px)) {
            body, .sidebar, .main-content {
                padding-left: max(15px, env(safe-area-inset-left));
                padding-right: max(15px, env(safe-area-inset-right));
            }
        }
    </style>
</head>
<body>
    <button class="menu-toggle" id="menuToggle">‚ò∞</button>
    
    <div class="container">
        <div class="sidebar" id="sidebar">
            <h2>
                Minhas Listas
                <span>üìã</span>
            </h2>
            
            <ul class="lists-menu" id="listsMenu">
                <!-- Listas ser√£o inseridas aqui dinamicamente -->
            </ul>
            
            <div class="add-list-form">
                <input type="text" id="newListName" placeholder="Nova lista">
                <button id="addListBtn">+</button>
            </div>
        </div>
        
        <div class="main-content">
            <div class="header">
                <h1>Calculadora de Listas</h1>
                <div class="current-list" id="currentList">Lista Principal</div>
            </div>
            
            <div class="input-section">
                <input type="text" id="itemName" placeholder="Nome do item">
                <input type="number" id="itemValue" placeholder="Valor" step="0.01">
                <button id="addBtn">Adicionar Item</button>
            </div>
            
            <table id="itemsTable">
                <thead>
                    <tr>
                        <th id="sortPosition">Posi√ß√£o <span class="sort-indicator">‚Üì</span></th>
                        <th id="sortName">Nome</th>
                        <th id="sortValue">Valor <span class="sort-indicator">‚Üì</span></th>
                        <th>A√ß√µes</th>
                    </tr>
                </thead>
                <tbody id="itemsList">
                    <!-- Itens ser√£o inseridos aqui dinamicamente -->
                </tbody>
            </table>
            
            <div class="total-section">
                <span>Total:</span>
                <span id="totalValue">MZN 0,00</span>
            </div>
            
            <div class="actions">
                <button id="sortByValueBtn" class="btn-warning">Ordenar por Valor</button>
                <button id="saveListBtn" class="btn-success">Salvar Lista</button>
                <button id="clearListBtn" class="btn-danger">Limpar Lista</button>
                <button id="exportPdfBtn" class="btn-success">Exportar para PDF</button>
            </div>
        </div>
    </div>

    <!-- Modal de Confirma√ß√£o -->
    <div class="modal" id="confirmModal">
        <div class="modal-content">
            <h3 id="modalTitle">Confirmar Exclus√£o</h3>
            <p id="modalMessage">Tem certeza que deseja excluir este item?</p>
            <div class="modal-actions">
                <button id="modalCancel" class="btn-warning">Cancelar</button>
                <button id="modalConfirm" class="btn-danger">Excluir</button>
            </div>
        </div>
    </div>

    <!-- Toast de notifica√ß√£o -->
    <div class="toast" id="toast"></div>

    <!-- Footer com Copyright -->
    <footer class="copyright">
        <p>&copy; 2025 <a href="https://infortecmov.netlify.app" target="_blank">Fernando J. Antonio</a>. Todos os direitos reservados.</p>
        <p>Desenvolvido com ‚ù§Ô∏è por <a href="https://infortecmov.netlify.app">Fernando J. Antonio</a></p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Elementos do DOM
            const menuToggle = document.getElementById('menuToggle');
            const sidebar = document.getElementById('sidebar');
            const listsMenu = document.getElementById('listsMenu');
            const newListName = document.getElementById('newListName');
            const addListBtn = document.getElementById('addListBtn');
            const currentList = document.getElementById('currentList');
            
            const itemNameInput = document.getElementById('itemName');
            const itemValueInput = document.getElementById('itemValue');
            const addBtn = document.getElementById('addBtn');
            const itemsList = document.getElementById('itemsList');
            const totalValue = document.getElementById('totalValue');
            const saveListBtn = document.getElementById('saveListBtn');
            const clearListBtn = document.getElementById('clearListBtn');
            const exportPdfBtn = document.getElementById('exportPdfBtn');
            const sortByValueBtn = document.getElementById('sortByValueBtn');
            const sortPosition = document.getElementById('sortPosition');
            const sortName = document.getElementById('sortName');
            const sortValue = document.getElementById('sortValue');
            
            // Elementos do Modal
            const confirmModal = document.getElementById('confirmModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalMessage = document.getElementById('modalMessage');
            const modalCancel = document.getElementById('modalCancel');
            const modalConfirm = document.getElementById('modalConfirm');
            
            // Toast
            const toast = document.getElementById('toast');
            
            // Gerenciamento de listas
            let lists = JSON.parse(localStorage.getItem('calculatorLists')) || {
                "Lista Principal": []
            };
            
            let currentListName = "Lista Principal";
            let sortOrder = 'desc'; // 'asc' ou 'desc'
            let sortField = 'value'; // 'value', 'name' ou 'position'
            let itemToDelete = null;
            
            // Fun√ß√£o para mostrar toast
            function showToast(message, type = 'success') {
                toast.textContent = message;
                toast.className = `toast ${type}`;
                toast.classList.add('show');
                
                setTimeout(() => {
                    toast.classList.remove('show');
                }, 3000);
            }
            
            // Fun√ß√£o para atualizar o menu de listas
            function updateListsMenu() {
                listsMenu.innerHTML = '';
                
                Object.keys(lists).forEach(listName => {
                    const listItem = document.createElement('li');
                    listItem.className = `list-item ${listName === currentListName ? 'active' : ''}`;
                    listItem.innerHTML = `
                        <span>${listName}</span>
                        <div class="list-actions">
                            <button class="edit-btn" data-list="${listName}">Editar</button>
                            <button class="delete-btn" data-list="${listName}">Excluir</button>
                        </div>
                    `;
                    listsMenu.appendChild(listItem);
                    
                    // Evento para selecionar a lista
                    listItem.querySelector('span').addEventListener('click', () => {
                        selectList(listName);
                    });
                    
                    // Evento para editar o nome da lista
                    listItem.querySelector('.edit-btn').addEventListener('click', (e) => {
                        e.stopPropagation();
                        editListName(listName);
                    });
                    
                    // Evento para excluir a lista
                    listItem.querySelector('.delete-btn').addEventListener('click', (e) => {
                        e.stopPropagation();
                        showDeleteListConfirmation(listName);
                    });
                });
            }
            
            // Fun√ß√£o para mostrar confirma√ß√£o de exclus√£o de lista
            function showDeleteListConfirmation(listName) {
                modalTitle.textContent = 'Excluir Lista';
                modalMessage.textContent = `Tem certeza que deseja excluir a lista "${listName}"? Todos os itens ser√£o perdidos.`;
                
                modalConfirm.onclick = () => deleteList(listName);
                
                confirmModal.style.display = 'flex';
            }
            
            // Fun√ß√£o para mostrar confirma√ß√£o de exclus√£o de item
            function showDeleteItemConfirmation(itemId) {
                modalTitle.textContent = 'Excluir Item';
                modalMessage.textContent = 'Tem certeza que deseja excluir este item?';
                
                modalConfirm.onclick = () => {
                    removeItem(itemId);
                    confirmModal.style.display = 'none';
                    showToast('Item exclu√≠do com sucesso!');
                };
                
                confirmModal.style.display = 'flex';
            }
            
            // Fun√ß√£o para selecionar uma lista
            function selectList(listName) {
                currentListName = listName;
                currentList.textContent = listName;
                updateListDisplay();
                updateListsMenu();
                
                // Fechar menu no mobile
                if (window.innerWidth <= 768) {
                    sidebar.classList.remove('active');
                }
                
                showToast(`Lista "${listName}" selecionada`);
            }
            
            // Fun√ß√£o para adicionar uma nova lista
            function addNewList() {
                const name = newListName.value.trim();
                
                if (name === '') {
                    showToast('Por favor, digite um nome para a lista.', 'error');
                    return;
                }
                
                if (lists[name]) {
                    showToast('J√° existe uma lista com este nome.', 'error');
                    return;
                }
                
                lists[name] = [];
                saveToLocalStorage();
                updateListsMenu();
                newListName.value = '';
                
                // Selecionar a nova lista
                selectList(name);
                showToast(`Lista "${name}" criada com sucesso!`);
            }
            
            // Fun√ß√£o para editar o nome de uma lista
            function editListName(oldName) {
                const newName = prompt('Digite o novo nome para a lista:', oldName);
                
                if (newName && newName.trim() !== '' && newName !== oldName) {
                    if (lists[newName]) {
                        showToast('J√° existe uma lista com este nome.', 'error');
                        return;
                    }
                    
                    lists[newName] = lists[oldName];
                    delete lists[oldName];
                    
                    if (currentListName === oldName) {
                        currentListName = newName;
                        currentList.textContent = newName;
                    }
                    
                    saveToLocalStorage();
                    updateListsMenu();
                    showToast(`Lista renomeada para "${newName}"`);
                }
            }
            
            // Fun√ß√£o para excluir uma lista
            function deleteList(listName) {
                if (Object.keys(lists).length === 1) {
                    showToast('Voc√™ n√£o pode excluir a √∫nica lista existente.', 'error');
                    confirmModal.style.display = 'none';
                    return;
                }
                
                delete lists[listName];
                
                // Se a lista atual foi exclu√≠da, selecionar a primeira dispon√≠vel
                if (currentListName === listName) {
                    const firstList = Object.keys(lists)[0];
                    selectList(firstList);
                }
                
                saveToLocalStorage();
                updateListsMenu();
                confirmModal.style.display = 'none';
                showToast(`Lista "${listName}" exclu√≠da com sucesso!`);
            }
            
            // Fun√ß√£o para obter a classe de posi√ß√£o
            function getPositionClass(position) {
                if (position === 1) return 'position-1';
                if (position === 2) return 'position-2';
                if (position === 3) return 'position-3';
                return 'position-other';
            }
            
            // Fun√ß√£o para obter o emoji de posi√ß√£o (apenas para visualiza√ß√£o web)
            function getPositionEmoji(position) {
                if (position === 1) return '1¬∫';
                if (position === 2) return '2¬∫';
                if (position === 3) return '3¬∫';
                return `${position}¬∫`;
            }
            
            // Fun√ß√£o para obter texto de posi√ß√£o (para PDF)
            function getPositionText(position) {
                if (position === 1) return '1¬∫';
                if (position === 2) return '2¬∫';
                if (position === 3) return '3¬∫';
                return `${position}¬∫`;
            }
            
            // Fun√ß√£o para ordenar os itens
            function sortItems(items) {
                return items.sort((a, b) => {
                    if (sortField === 'value') {
                        return sortOrder === 'desc' ? b.value - a.value : a.value - b.value;
                    } else if (sortField === 'name') {
                        return sortOrder === 'desc' 
                            ? b.name.localeCompare(a.name) 
                            : a.name.localeCompare(b.name);
                    }
                    // Para posi√ß√£o, mantemos a ordem atual
                    return 0;
                });
            }
            
            // Fun√ß√£o para atualizar a exibi√ß√£o da lista
            function updateListDisplay() {
                let items = lists[currentListName] || [];
                
                // Ordenar os itens
                items = sortItems([...items]);
                
                itemsList.innerHTML = '';
                
                if (items.length === 0) {
                    itemsList.innerHTML = '<tr><td colspan="4" class="empty-message">Nenhum item adicionado ainda</td></tr>';
                    totalValue.textContent = 'MZN 0,00';
                    return;
                }
                
                let total = 0;
                
                items.forEach((item, index) => {
                    const position = index + 1;
                    const positionClass = getPositionClass(position);
                    const positionEmoji = getPositionEmoji(position);
                    
                    const row = document.createElement('tr');
                    row.className = positionClass;
                    row.innerHTML = `
                        <td>
                            <span class="position-badge">${position}</span>
                            ${positionEmoji}
                        </td>
                        <td>${item.name}</td>
                        <td>MZN ${parseFloat(item.value).toFixed(2).replace('.', ',')}</td>
                        <td>
                            <div class="item-actions">
                                <button class="edit-name-btn" data-id="${item.id}">Editar Nome</button>
                                <button class="edit-value-btn" data-id="${item.id}">Editar Valor</button>
                                <button class="delete-item-btn" data-id="${item.id}">Excluir</button>
                            </div>
                        </td>
                    `;
                    itemsList.appendChild(row);
                    total += parseFloat(item.value);
                });
                
                totalValue.textContent = `MZN ${total.toFixed(2).replace('.', ',')}`;
                
                // Atualizar indicadores de ordena√ß√£o
                updateSortIndicators();
            }
            
            // Fun√ß√£o para atualizar os indicadores de ordena√ß√£o
            function updateSortIndicators() {
                // Remover todos os indicadores
                document.querySelectorAll('.sort-indicator').forEach(indicator => {
                    indicator.textContent = '';
                });
                
                // Adicionar indicador na coluna atual
                if (sortField === 'value') {
                    sortValue.querySelector('.sort-indicator').textContent = sortOrder === 'desc' ? '‚Üì' : '‚Üë';
                } else if (sortField === 'name') {
                    sortName.querySelector('.sort-indicator').textContent = sortOrder === 'desc' ? '‚Üì' : '‚Üë';
                }
            }
            
            // Fun√ß√£o para adicionar item
            function addItem() {
                const name = itemNameInput.value.trim();
                const value = parseFloat(itemValueInput.value);
                
                if (name === '' || isNaN(value) || value <= 0) {
                    showToast('Por favor, preencha o nome e um valor v√°lido.', 'error');
                    return;
                }
                
                const newItem = {
                    id: Date.now().toString(),
                    name,
                    value
                };
                
                lists[currentListName].push(newItem);
                saveToLocalStorage();
                updateListDisplay();
                
                // Limpar campos de entrada
                itemNameInput.value = '';
                itemValueInput.value = '';
                itemNameInput.focus();
                
                showToast('Item adicionado com sucesso!');
            }
            
            // Fun√ß√£o para editar nome do item
            function editItemName(id) {
                const items = lists[currentListName];
                const itemIndex = items.findIndex(item => item.id === id);
                
                if (itemIndex === -1) return;
                
                const item = items[itemIndex];
                const newName = prompt('Editar nome:', item.name);
                
                if (newName !== null && newName.trim() !== '') {
                    items[itemIndex].name = newName.trim();
                    saveToLocalStorage();
                    updateListDisplay();
                    showToast('Nome do item atualizado com sucesso!');
                }
            }
            
            // Fun√ß√£o para editar valor do item
            function editItemValue(id) {
                const items = lists[currentListName];
                const itemIndex = items.findIndex(item => item.id === id);
                
                if (itemIndex === -1) return;
                
                const item = items[itemIndex];
                const newValue = parseFloat(prompt('Editar valor:', item.value));
                
                if (newValue !== null && !isNaN(newValue) && newValue > 0) {
                    items[itemIndex].value = newValue;
                    saveToLocalStorage();
                    updateListDisplay();
                    showToast('Valor do item atualizado com sucesso!');
                }
            }
            
            // Fun√ß√£o para remover item
            function removeItem(id) {
                lists[currentListName] = lists[currentListName].filter(item => item.id !== id);
                saveToLocalStorage();
                updateListDisplay();
            }
            
            // Fun√ß√£o para salvar no localStorage
            function saveToLocalStorage() {
                localStorage.setItem('calculatorLists', JSON.stringify(lists));
            }
            
            // Fun√ß√£o para limpar lista
            function clearList() {
                if (lists[currentListName].length === 0) {
                    showToast('A lista j√° est√° vazia.', 'warning');
                    return;
                }
                
                if (confirm('Tem certeza que deseja limpar toda a lista?')) {
                    lists[currentListName] = [];
                    saveToLocalStorage();
                    updateListDisplay();
                    showToast('Lista limpa com sucesso!');
                }
            }
            
            // Fun√ß√£o para exportar para PDF
            function exportToPdf() {
                // Ordenar itens para o PDF
                const items = sortItems([...lists[currentListName]]);
                
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                
                // Configurar fonte que suporta melhor caracteres especiais
                doc.setFont('helvetica');
                
                // T√≠tulo
                doc.setFontSize(20);
                doc.text(`Lista: ${currentListName}`, 20, 20);
                
                // Data
                const now = new Date();
                const dateStr = now.toLocaleDateString('pt-BR');
                const timeStr = now.toLocaleTimeString('pt-BR');
                doc.setFontSize(12);
                doc.text(`Gerado em: ${dateStr} √†s ${timeStr}`, 20, 30);
                
                // Verificar se h√° itens
                if (items.length === 0) {
                    doc.setFontSize(16);
                    doc.text('Nenhum item adicionado ainda', 20, 50);
                } else {
                    // Tabela
                    const tableColumn = ["Posi√ß√£o", "Nome", "Valor (MZN)"];
                    const tableRows = [];
                    
                    let total = 0;
                    items.forEach((item, index) => {
                        const position = index + 1;
                        const positionText = getPositionText(position);
                        
                        const itemData = [
                            positionText,
                            item.name,
                            parseFloat(item.value).toFixed(2).replace('.', ',')
                        ];
                        tableRows.push(itemData);
                        total += parseFloat(item.value);
                    });
                    
                    // Adicionar linha do total
                    tableRows.push(["", "TOTAL:", total.toFixed(2).replace('.', ',')]);
                    
                    doc.autoTable({
                        head: [tableColumn],
                        body: tableRows,
                        startY: 40,
                        styles: { 
                            fontSize: 10,
                            font: 'helvetica'
                        },
                        headStyles: { 
                            fillColor: [52, 152, 219],
                            font: 'helvetica'
                        },
                        footStyles: { 
                            fillColor: [231, 76, 60],
                            font: 'helvetica'
                        },
                        didDrawPage: function (data) {
                            // Adicionar n√∫mero da p√°gina
                            doc.setFontSize(10);
                            doc.text(
                                `P√°gina ${doc.internal.getNumberOfPages()}`,
                                data.settings.margin.left,
                                doc.internal.pageSize.height - 10
                            );
                        }
                    });
                }
                
                // Salvar o PDF
                const fileName = `${currentListName.replace(/\s+/g, '_')}_${dateStr.replace(/\//g, '-')}.pdf`;
                
                // Tentar usar save primeiro, se falhar usar output
                try {
                    doc.save(fileName);
                    showToast('PDF exportado com sucesso!');
                } catch (error) {
                    console.log('Erro ao salvar PDF, tentando m√©todo alternativo:', error);
                    // M√©todo alternativo para dispositivos m√≥veis
                    const pdfOutput = doc.output('blob');
                    const url = URL.createObjectURL(pdfOutput);
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = fileName;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    URL.revokeObjectURL(url);
                    showToast('PDF exportado com sucesso!');
                }
            }
            
            // Event Listeners
            menuToggle.addEventListener('click', () => {
                sidebar.classList.toggle('active');
            });
            
            addListBtn.addEventListener('click', addNewList);
            
            newListName.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    addNewList();
                }
            });
            
            addBtn.addEventListener('click', addItem);
            
            itemValueInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    addItem();
                }
            });
            
            saveListBtn.addEventListener('click', () => {
                saveToLocalStorage();
                showToast('Lista salva com sucesso!');
            });
            
            clearListBtn.addEventListener('click', clearList);
            
            exportPdfBtn.addEventListener('click', exportToPdf);
            
            sortByValueBtn.addEventListener('click', () => {
                if (sortField === 'value') {
                    sortOrder = sortOrder === 'desc' ? 'asc' : 'desc';
                } else {
                    sortField = 'value';
                    sortOrder = 'desc';
                }
                updateListDisplay();
            });
            
            sortPosition.addEventListener('click', () => {
                // A posi√ß√£o √© determinada pela ordena√ß√£o atual, ent√£o n√£o faz sentido ordenar por posi√ß√£o
                showToast('A posi√ß√£o √© determinada automaticamente pela ordena√ß√£o dos valores.', 'info');
            });
            
            sortName.addEventListener('click', () => {
                if (sortField === 'name') {
                    sortOrder = sortOrder === 'desc' ? 'asc' : 'desc';
                } else {
                    sortField = 'name';
                    sortOrder = 'desc';
                }
                updateListDisplay();
            });
            
            sortValue.addEventListener('click', () => {
                if (sortField === 'value') {
                    sortOrder = sortOrder === 'desc' ? 'asc' : 'desc';
                } else {
                    sortField = 'value';
                    sortOrder = 'desc';
                }
                updateListDisplay();
            });
            
            // Delegar eventos para os bot√µes de a√ß√£o dos itens
            itemsList.addEventListener('click', (e) => {
                const target = e.target;
                const id = target.getAttribute('data-id');
                
                if (!id) return;
                
                if (target.classList.contains('edit-name-btn')) {
                    editItemName(id);
                } else if (target.classList.contains('edit-value-btn')) {
                    editItemValue(id);
                } else if (target.classList.contains('delete-item-btn')) {
                    showDeleteItemConfirmation(id);
                }
            });
            
            // Eventos do modal
            modalCancel.addEventListener('click', () => {
                confirmModal.style.display = 'none';
            });
            
            // Fechar modal ao clicar fora
            window.addEventListener('click', (e) => {
                if (e.target === confirmModal) {
                    confirmModal.style.display = 'none';
                }
            });
            
            // Inicializa√ß√£o
            updateListsMenu();
            updateListDisplay();
            
            // Focar no campo de nome do item ao carregar
            itemNameInput.focus();
            
            // Mostrar mensagem de boas-vindas
            setTimeout(() => {
                showToast('Bem-vindo √† Calculadora personalizada!');
            }, 1000);
        });
    </script>
</body>
</html>